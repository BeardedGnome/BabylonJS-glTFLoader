<!DOCTYPE html>
<html>
<head>
    <script src="scripts/dat.gui.min.js"></script>
    <script src="scripts/babylon.max.js"></script>
    <script src="scripts/babylon.glTFFileLoader.js"></script>   
</head>
<body>  
    <canvas id="renderCanvas"></canvas>
    <script>
        var canvas = document.getElementById("renderCanvas");
        var engine = null;


        function load(url) {
            canvas.width = 800;
            canvas.height = 480;

            if (engine) {
                engine.dispose();
            }

            engine = new BABYLON.Engine(canvas, true);
            engine.enableOfflineSupport = false;

            var split = url.lastIndexOf("/");
            var rootUrl = url.substring(0, split + 1);
            var fileName = url.substring(split + 1, url.length);

            BABYLON.SceneLoader.Load(rootUrl, fileName, engine, function (scene) {
                var camera = new BABYLON.ArcRotateCamera("camera", 0, 0, 1, BABYLON.Vector3.Zero(), scene);
                camera.setPosition(new BABYLON.Vector3(0, 0, 10));
                camera.attachControl(canvas);
                scene.activeCamera = camera;

                var light = new BABYLON.DirectionalLight("light1", new BABYLON.Quaternion(0.4082179, -0.2345697, 0.1093817, 0.8754261), scene);
                light.intensity = 0.7;

                engine.runRenderLoop(function () {
                    scene.render();
                });
            });
        }
        
        function getSampleModelUrl(glb, name) {
            if (glb) {
                return "https://raw.githubusercontent.com/KhronosGroup/glTF/master/sampleModels/" + name + "/glTF-Binary/" + name + ".glb";
            }
            else {
                return "https://raw.githubusercontent.com/KhronosGroup/glTF/master/sampleModels/" + name + "/glTF/" + name + ".gltf";
            }
        }

        var menu = function(){
            this.model = "Box";
            this.filetype = "gltf";
            this.load = function () {
            if (this.filetype==="glb") {
                load("https://raw.githubusercontent.com/KhronosGroup/glTF/master/sampleModels/" + this.model + "/glTF-Binary/" + this.model + ".glb");
            }
            else {
                load("https://raw.githubusercontent.com/KhronosGroup/glTF/master/sampleModels/" + this.model + "/glTF/" + this.model + ".gltf");
            }
            };
            this.loadPBR = function (){
                load('Models/PBR/Cloth_IronOld.gltf');
            }
        }

        window.onload = function() {
                var text = new menu();
                var gui = new dat.GUI();
                gui.add(text, 'model', ['Box','2CylinderEngine','BoxAnimated','BoxSemantics','BoxTextured','BoxWithoutIndices','BrainStem','Buggy','CesiumMan','CesiumMilkTruck','Duck','GearboxAssy','Monster','ReciprocatingSaw','RiggerFigure','RiggedSimple','VC']);
                gui.add(text,'filetype',['gltf','glb']);
                gui.add(text,'load');
                gui.add(text,'loadPBR');        
        }

    </script>
</body>
</html>
