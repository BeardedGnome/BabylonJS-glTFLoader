<!DOCTYPE html>
<html>
<head>
    <script src="scripts/dat.gui.min.js"></script>
    <script src="scripts/babylon.2.5.js"></script>
    <script src="scripts/babylon.glTFFileLoader.js"></script>   
</head>
<body>  
    <canvas id="renderCanvas"></canvas>
    <script>
        var canvas = document.getElementById("renderCanvas");
        var engine = null;


        function load(url) {
            canvas.width = 800;
            canvas.height = 600;

            if (engine) {
                engine.dispose();
            }

            engine = new BABYLON.Engine(canvas, true);
            engine.enableOfflineSupport = false;

            var split = url.lastIndexOf("/");
            var rootUrl = url.substring(0, split + 1);
            var fileName = url.substring(split + 1, url.length);

            BABYLON.SceneLoader.Load(rootUrl, fileName, engine, function (scene) {
                
                camera = new BABYLON.ArcRotateCamera("camera", 0, 1, 5, BABYLON.Vector3.Zero(), scene);
                camera.attachControl(canvas, false, false);
                camera.panningSensibility = 50.0;
                camera.angularSensibility = 500;
                scene.activeCamera = camera;
                scene.debugLayer.show(true, camera);


                var light = new BABYLON.DirectionalLight("light1", new BABYLON.Quaternion(0.4082179, -0.2345697, 0.1093817, 0.8754261), scene);
                light.intensity = 0.7;

                engine.runRenderLoop(function () {
                    scene.render();
                });
            });
        }
        

        var Menu = function(){
            this.model = "Telephone";
            this.type = "PBR-SpecGloss";
        }

        var menu = new Menu();

        function updateModel() {
            if (menu.type === "PBR-MetalRoughness") {
                alert("Not implemented yet");
                }
            else 
                {
                load('Models/'+menu.model+'/'+menu.type+'/'+menu.model+'.gltf');
                }
        
            };

        
        window.onload = function() {
                var gui = new dat.GUI();
                var model = gui.add(menu, 'model', ['Telephone','Avocado','BarramundiFish','FarmLandDiorama']);
                var type = gui.add(menu,'type',['PBR-SpecGloss','PBR-MetalRoughness','glTF']); 
               
                model.onFinishChange(updateModel);
                type.onFinishChange(updateModel);
                load('Models/Telephone/PBR-SpecGloss/Telephone.gltf');
        }

    </script>
</body>
</html>
